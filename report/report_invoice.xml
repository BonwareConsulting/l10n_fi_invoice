<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
    <template id="report_invoice_finnish_document">
        <t t-name="account.report_invoice_document">
            <t t-call="finnish-invoice.report_layout_finnish">
                <div class="page">
                    <style type="text/css">
                        .padding-correction {
                            padding-right: 15px;
                            padding-left: 15px;
                        }

                        hr {
                            border-top: 2px solid #eee;
                            margin-left: -15px;
                            margin-right: -15px;
                        }
                        
                        .bank-transfer-wrap .row .row > div {
                          padding-top: 5px;
                          padding-bottom: 5px;
                        }

                        .bank-transfer-label {
                            font-size: 9px;
                            text-align: right;
                            line-height: 10px;
                            padding: 3px;
                        }

                        .border-right {
                            border-right: 2px solid black;
                        }

                        .border-left {
                            border-left: 2px solid black;
                        }

                        .border-bottom {
                            border-bottom: 2px solid black;
                        }

                        .medium-row > div {
                            height: 4em;
                        }

                        .small-row > div {
                          height: 2em;
                        }

                        .invoice-info tr td:last-child {
                            padding-left: 3em;
                        }

                        address span[itemprop=name] {
                          font-weight: bold;
                        }
                    </style>
                    <div class="padding-correction">
                        <div class="row">
                            <div class="col-xs-6 col-xs-offset-1" style="margin-top: 5em; margin-bottom: 4em; font-size:1.1em;">
                                <address t-field="o.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: true}"/>
                                <span t-if="o.partner_id.vat">VAT: <span t-field="o.partner_id.vat"/></span>
                            </div>
                            <div class="col-xs-5">
                                <table class="invoice-info">
                                    <tr><td><span>Invoice number</span></td><td><t t-esc="o.id"></t></td></tr>
                                    <tr><td><span>Invoice reference</span></td><td><!--TODO: Viitenumero--></td></tr>
                                    <tr><td><span>Date due</span></td><td><span t-field="o.date_due"/></td></tr>
                                    <tr><td>Invoice Date</td><td><span t-field="o.date_invoice"/></td></tr>
                                    <tr><td>Date fulfilled</td><td></td></tr>
                                    <tr><td>Payment term</td><td><span t-field="o.payment_term"></span></td></tr>
                                    <tr><td>Our reference</td><td><span t-field="o.origin"></span></td></tr>
                                    <tr><td>Your reference</td><td><span t-field="o.reference"></span></td></tr>
                                </table>
                            </div>
                        </div>
                        <hr />
                        <h2>
                            <span t-if="o.type == 'out_invoice' and (o.state == 'open' or o.state == 'paid')">Invoice</span>
                            <span t-if="o.type == 'out_invoice' and o.state == 'proforma2'">PRO-FORMA</span>
                            <span t-if="o.type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                            <span t-if="o.type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                            <span t-if="o.type == 'out_refund'">Refund</span>
                            <span t-if="o.type == 'in_refund'">Supplier Refund</span>
                            <span t-if="o.type == 'in_invoice'">Supplier Invoice</span>
                            <span t-field="o.number"/>
                        </h2>

                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th>Description</th>
                                    <th>Quantity</th>
                                    <th class="text-right">Unit Price</th>
                                    <th class="text-right" groups="sale.group_discount_per_so_line">Discount (%)</th>
                                    <th class="text-right">Taxes</th>
                                    <th class="text-right">Amount</th>
                                </tr>
                            </thead>
                            <tbody class="invoice_tbody">
                                <tr t-foreach="o.invoice_line" t-as="l">
                                    <td><span t-field="l.name"/></td>
                                    <td>
                                        <span t-field="l.quantity"/>
                                        <span t-field="l.uos_id" groups="product.group_uom"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="l.price_unit"/>
                                    </td>
                                    <td class="text-right" groups="sale.group_discount_per_so_line"><span t-field="l.discount"/></td>
                                    <td class="text-right">
                                        <span t-esc="', '.join(map(lambda x: x.name, l.invoice_line_tax_id))"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="l.price_subtotal" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="row">
                            <div class="col-xs-4 pull-right">
                                <table class="table table-condensed">
                                    <tr class="border-black">
                                        <td><strong>Total Without Taxes</strong></td>
                                        <td class="text-right">
                                            <span t-field="o.amount_untaxed" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Taxes</td>
                                        <td class="text-right">
                                            <span t-field="o.amount_tax" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                        </td>
                                    </tr>
                                    <tr class="border-black">
                                        <td><strong>Total</strong></td>
                                        <td class="text-right">
                                            <span t-field="o.amount_total" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <div class="row" t-if="o.tax_line">
                            <div class="col-xs-6 col-xs-offset-6">
                                <table class="table table-condensed">
                                    <thead>
                                        <tr>
                                            <th>Tax</th>
                                            <th class="text-right">Base</th>
                                            <th class="text-right">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="o.tax_line" t-as="t">
                                            <td><span t-field="t.name"/></td>
                                            <td class="text-right">
                                                <span t-field="t.base" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-field="t.amount" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <hr />
                    <script type="text/javascript" src="/web/static/lib/jquery/jquery.js" />
                    <script>
                        jQuery(document).ready(function(){
                            var elem1_h = jQuery("#company-info").height();
                            var elem2_h = 200 - elem1_h;
                            jQuery("#payer-info").css("height", elem2_h);
                        });
                    </script>
                    <div class="bank-transfer-wrap last-page" style="page-break-inside: avoid;">
                       <div class="row row-eq-height border-bottom" style="border-top: 1px dashed gray">
                           <div class="col-xs-7 border-right">
                               <div class="row row-eq-height border-bottom medium-row">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>
                                           Saajan
                                           tilinumero
                                       </div>
                                       <div>
                                           Moottagarens
                                           kontonummer
                                       </div>
                                   </div>
                                   <div class="col-xs-10 border-left">
                                       TODO: IBAN
                                   </div>
                               </div>
                               <div class="row row-eq-height border-bottom">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>
                                           Saaja
                                       </div>
                                       <div>
                                           Moottagare
                                       </div>
                                   </div>
                                   <div class="col-xs-10 border-left" id="company-info" style="height: 6em">
                                       <div t-field="o.company_id.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: true}"/>
                                   </div>
                               </div>
                               <div class="row row-eq-height">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>
                                           Maksaja
                                       </div>
                                       <div>
                                           Betalare
                                       </div>
                                   </div>
                                   <div class="col-xs-10" id="payer-info" style="height: 9em;">
                                       <div t-field="o.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: true}"/>
                                   </div>
                               </div>
                               <div class="row row-eq-height border-bottom small-row">
                                   <div class="col-xs-2 bank-transfer-label" style="font-size: 9px; text-align: right; line-height: 10px; min-height: 0;">
                                       <div>
                                           Allekirjoitus
                                       </div>
                                       <div>
                                           Underskrift
                                       </div>
                                   </div>
                                   <div class="col-xs-10" style="min-height: 0;">
                                       <div style="border-bottom: 1px solid black; margin-top: 15px;"></div>
                                   </div>
                               </div>
                               <div class="row row-eq-height small-row">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>
                                           Tililtä nro
                                       </div>
                                       <div>
                                           Från konto nr
                                       </div>
                                   </div>
                                   <div class="col-xs-10" style="border-left: 1px solid black;">
                                   </div>
                               </div>
                           </div>
                           <div class="col-xs-5">
                               <div class="row border-bottom medium-row">
                                   <div class="col-xs-2 bank-transfer-label">BIC</div>
                                   <div class="col-xs-10"></div>
                               </div>
                               <div class="row border-bottom">
                                   <div class="col-xs-12" style="height: 15em;">
                                       Laskun numero
                                   </div>
                               </div>
                               <div class="row row-eq-height border-bottom small-row">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>
                                           Viitenro
                                       </div>
                                       <div>
                                           Ref.nr
                                       </div>
                                   </div>
                                   <div class="col-xs-10 border-left">
                                       TODO: Viitenumero
                                   </div>
                               </div>
                               <div class="row row-eq-height small-row">
                                   <div class="col-xs-2 bank-transfer-label">
                                       <div>Eräpäivä</div>
                                       <div>Förf.dag</div>
                                   </div>
                                   <div class="col-xs-4 border-left">
                                       <span t-field="o.date_due"></span>
                                   </div>
                                   <div class="col-xs-6 border-left">
                                       <span class="bank-transfer-label">Euro</span><span t-field="o.amount_total" style="float: right;"></span>
                                   </div>
                               </div>
                           </div>
                       </div>
                       <div class="row">
                           <!--TODO: BARCODE?-->
                       </div>
                   </div>
                </div>
            </t>
        </t>
    </template>

    <template id="report_invoice_finnish_translate" t-name="Finnish Invoice">
        <t t-call="report.html_container">
            <t t-foreach="doc_ids" t-as="doc_id">
                <t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'finnish-invoice.report_invoice_finnish_document')"/>
            </t>
        </t>
    </template>

    <report
        string="Finnish Invoice"
        id="report_invoice_finnish"
        model="account.invoice"
        report_type="qweb-html"
        name="finnish-invoice.report_invoice_finnish_translate"
        file="finnish-invoice.report_invoice_finnish_translate"
        />

    <!--Make custom paper format to eliminate margins-->
    <record id="paperformat_finnish" model="report.paperformat">
        <field name="name">Finnish Invoice w/ Transfer</field>
        <field name="default" eval="False"/>
        <field name="format">A4</field>
        <field name="orientation">Portrait</field>
        <!--Fix overly large header-->
        <field name="margin_top">20</field>
        <field name="header_spacing">15</field>
        <!--Remove template footer-->
        <field name="margin_bottom">0</field>
        <!--Remove side margins-->
        <field name="margin_left">0</field>
        <field name="margin_right">0</field>
        <field name="dpi">100</field>
    </record>

    <!--Make report use custom paper format-->
    <record id="finnish-invoice.report_invoice_finnish" model="ir.actions.report.xml">
        <field name="paperformat_id" ref="finnish-invoice.paperformat_finnish" />
    </record>

</data>
</openerp>
